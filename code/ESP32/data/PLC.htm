#pragma once

const char home_html[] PROGMEM = R"rawliteral(
	<!DOCTYPE html>
	<html lang=\"en\">
	<head><meta name=\"viewport\" content=\"width=device-width, initial-scale=1, user-scalable=no\"/>
	<title>{n}</title>
	<link rel="stylesheet" href="/style.css">
	<script>
		function initWebSocket() {
		  const socket = new WebSocket('ws://' + window.location.hostname + '/ws_home');
		  socket.onmessage = function(event) {
				const gpioValues = JSON.parse(event.data);
				for (const [key, value] of Object.entries(gpioValues)) {
					// console.log(`Pin: ${key}, State: ${value}`);
					const el = document.getElementById(`${key}`);
					if (el) {
						const isNumeric = !isNaN(`${value}`);
						if (isNumeric) {
							el.innerText = `${key}: ${value}`;
							el.style.backgroundColor = '#301934';
						} else {
							if (`${value}` === `High` || `${value}` === `On`) {
								el.style.backgroundColor = 'green';
							} else {
								el.style.backgroundColor = 'red';
							}
						}
					}
				}
			};

			socket.onerror = function(error) {
      			console.error('WebSocket error:', error);
    		};

			window.addEventListener('beforeunload', function() {
				if (socket) {
					socket.close();
				}
			});
		}

		window.onload = function() {
		  initWebSocket();
		}
	</script>
	</head>
  	<body>
		<div id="home">
    		<div id="hdr">
				<h2>{n}</h2>
				<div style='font-size: .6em;'>Firmware version '{v}'</div>
				<hr>
				<div class="container">
					<div class="home-group">
						<fieldset class="fs"><legend>Digital Inputs</legend>
						<div class="desc">{digitalInputDesc}</div>
						{digitalInputs}
						</fieldset>
						<fieldset class="fs"><legend>Digital Outputs</legend>
						<div class="desc">{digitalOutputDesc}</div>
						{digitalOutputs}
						</fieldset>
						<fieldset class="fs"><legend>Analog Inputs</legend>
						<div class="desc">{analogInputDesc}</div>
						{analogInputs}
						</fieldset>
						<fieldset class="fs"><legend>Analog Outputs</legend>
						<div class="desc">{analogOutputDesc}</div>
						{analogOutputs}
						</fieldset>
						<div class="link-row">
							<p><a href='settings'>Settings</a></p>
							<p><a href='/log' target='_blank'>Web Log</a></p>
						</div>
					</div>
				</div>
			</div>
  		</div>
	</body>
	</html>
	)rawliteral";

const char app_config_fields[] PROGMEM = R"rawliteral(
	%modbusBridgeAppSettings%
	<fieldset id="app" class="fs">
	<legend>Application</legend>
		<div class="conv">
			%acf%
		</div>
	</fieldset>
)rawliteral";

const char analog_conv_flds[] PROGMEM = R"rawliteral(
	<div class="fld">
	<div class="app-range-row">
		<label for="conversions[{An}].minV">A{An} Min V:</label>
		<input type="number" id="conversions[{An}].minV" name="conversions[{An}].minV" step="0.1" min="0" max="10" required>
		<label for="conversions[{An}].minT">=></label>
		<input type="number" id="conversions[{An}].minT" name="conversions[{An}].minT" required>

		<label for="conversions[{An}].maxV">A{An} Max V:</label>
		<input type="number" id="conversions[{An}].maxV" name="conversions[{An}].maxV" step="0.1" min="0" max="10" required>
		<label for="conversions[{An}].maxT">=></label>
		<input type="number" id="conversions[{An}].maxT" name="conversions[{An}].maxT" required>
	</div>
  </div>
)rawliteral";

const char app_validateInputs[] PROGMEM = R"rawliteral(
	const A{An}_minval = parseFloat(document.getElementById('conversions[{An}].minV').value);
	const A{An}_maxval = parseFloat(document.getElementById('conversions[{An}].maxV').value);
	if (A{An}_minval >= A{An}_maxval) {
		alert('The A{An} min must be lower than A{An} max.');
		return false;
	}
	const A{An}_min_tval = parseFloat(document.getElementById('conversions[{An}].minT').value);
	const A{An}_max_tval = parseFloat(document.getElementById('conversions[{An}].maxT').value);
	if (A{An}_min_tval >= A{An}_max_tval) {
		alert('The A{An} min => must be lower than A{An} => max.');
		return false;
	}
)rawliteral";

const char config_modbusBridge[] PROGMEM = R"rawliteral(
<div id="mbflds">	
	<fieldset id="modbusBridge" class="fs">
	<legend><label><input type="checkbox" id="modbusBridgeCheckbox" name="useModbusBridge" onclick="modbusBridgeFieldset(this)" {modbusBridgechecked}> Modbus Bridge</label></legend>
		<div class="form-grid">
			<label for="clientRTUBaud">RTU Baud Rate</label>
			<select id="clientRTUBaud" name="clientRTUBaud">
				<option value="9600" {RTU_CLIENT_9600} >9600</option>
				<option value="19200" {RTU_CLIENT_19200} >19200</option>
				<option value="38400" {RTU_CLIENT_38400} >38400</option>
				<option value="115200" {RTU_CLIENT_115200} >115200</option>
			</select>
		</div>
		<div class="form-grid">
			<label for="clientRTUParity">RTU Parity</label>
			<select id="clientRTUParity" name="clientRTUParity">
				<option value="none" {RTU_CLIENT_Parity_None}>None</option>
				<option value="even" {RTU_CLIENT_Parity_Even}>Even</option>
				<option value="odd" {RTU_CLIENT_Parity_Odd}>Odd</option>
			</select>
		</div>
		<div class="form-grid">
			<label for="clientRTUStopBits">RTU Stop Bits</label>
			<select id="clientRTUStopBits" name="clientRTUStopBits">
				<option value="1" {RTU_CLIENT_1Stop}>1</option>
				<option value="2" {RTU_CLIENT_2Stop}>2</option>
			</select>
		</div>
		<div class="modbus-bridge-row">
			<label>Input</label>
			<label for="inputBridgeID">ID</label><input type="number" id="inputBridgeID" name="inputBridgeID"  step="1">
			<label for="inputRegBridge">Address</label><input type="number" id="inputRegBridge" name="inputRegBridge" step="1" min="0" max="65531">
			<label for="inputRegBridgeCount">Count</label><input type="number" id="inputRegBridgeCount" name="inputRegBridgeCount" step="1" min="0" max="16">
		</div>
		<div class="modbus-bridge-row">
			<label>Coil</label>
			<label for="coilBridgeID">ID</label><input type="number" id="coilBridgeID" name="coilBridgeID" step="1">
			<label for="coilBridge">Address</label><input type="number" id="coilBridge" name="coilBridge" step="1" min="0" max="65529">
			<label for="coilBridgeCount">Count</label><input type="number" id="coilBridgeCount" name="coilBridgeCount" step="1" min="0" max="16">
		</div>
		<div class="modbus-bridge-row">
			<label>Discrete</label>
			<label for="discreteBridgeID">ID</label><input type="number" id="discreteBridgeID" name="discreteBridgeID" step="1">
			<label for="discreteBridge">Address</label><input type="number" id="discreteBridge" name="discreteBridge" step="1" min="0" max="65531">
			<label for="discreteBridgeCount">Count</label><input type="number" id="discreteBridgeCount" name="discreteBridgeCount" step="1" min="0" max="16">
		</div>
		<div class="modbus-bridge-row">
			<label>Holding</label>
			<label for="holdingBridgeID">ID</label><input type="number" id="holdingBridgeID" name="holdingBridgeID" step="1">
			<label for="holdingRegBridge">Address</label><input type="number" id="holdingRegBridge" name="holdingRegBridge" step="1" min="0" max="65531">
			<label for="holdingRegBridgeCount">Count</label><input type="number" id="holdingRegBridgeCount" name="holdingRegBridgeCount" step="1" min="0" max="16">
		</div>

  	</fieldset>
</div>
)rawliteral";